## Cookie

- 클라이언트가 웹사이트에 접속할 때 그 사이트가 사용하게 되는 일련의 작은 기록 파일
- 브라우저에 저장되어서 접속자 장치를 인식하거나 일부 데이터를 저장하는 역할을 함
- 서버가 클라이언트에 정보를 전달할 때 저장하고자 하는 정보를 응답 헤더(Cookie)에 저장하여 전달
- Key Value 형식의 문자열 형태로 저장

<br>

쿠키가 필요한 이유는?
> 서버는 요청을 보내는 클라이언트가 누구인지 알 수 없기 때문 <br>
> 클라이언트를 식별하기 위해 서버는 응답 시 쿠키를 동봉해서 보냄 <br>
> 클라이언트는 받은 쿠키를 가지고 있다가 다음 요청 때 쿠키를 함께 보냄 <br>
> 서버는 쿠키를 통해 요청자가 누구인지 파악함

<img width="550" alt="image" src="https://user-images.githubusercontent.com/66426083/168890102-3590a4d1-2ee5-44dc-aca9-76d2b228808b.png">


### 쿠키의 단점
  
- 쿠키는 노출이 되었을 때 id, pw에 대한 민감한 정보까지 다 노출이 되어 보안이 좋지 않다.
  
  <img width="674" alt="image" src="https://user-images.githubusercontent.com/66426083/168883407-bbf5380e-83b7-4600-bf88-47835c5988a7.png">

- 조작당해서 들어올 가능성이 있다.
- 웹 브라우저마다 쿠키에 대한 지원 형태가 다르기 때문에 다른 브라우저간의 공유가 불가능하다.
- 쿠키의 사이즈가 제한(4KB)되어있어 원하는 만큼의 충분한 데이터를 담을 수 없을 경우가 있다.
- 서버는 매번 id pw를 받아서 인증을 해야 하는 불편함이 있으며 조작된 데이터가 넘어오는 경우를 방지할 수 없다.
  
<br>
  
---
  
  <br>
  
## Session
  
- 개인 민감정보를 그대로 노출했을 때의 단점을 막아내기 위해서 나온 것
- 인증 정보 자체를 세션 저장소에 저장하고, 이 값을 쿠키에 담아 클라이언트가 쿠키를 요청할 때마다 세션 저장소에 있는 정보랑 동일한지로 로그인 확인
  
  <img width="550" alt="image" src="https://user-images.githubusercontent.com/66426083/168889869-03c46635-16ad-42c7-bc08-ef21c321ec1a.png">

<br>

### 세션의 단점

- 세션 저장소의 문제가 발생하면 인증 체계가 무너져 이전에 다른 인증된 유저 또한 인증이 불가해진다.
- stateful 하기 때문에 http의 장점을 발휘하지 못하고 scale out에 걸림돌이 생긴다.
- 세션 저장소가 필수적으로 존재하기 때문에 이를 사용하기 위한 비용이 든다.
- 세션 ID가 탈취되었을 경우 대처는 가능하지만 클라이언트 인척 위장하는 보안의 약점이 있을 수 있다.
- 사용자가 많아질수록 메모리를 많이 차지하게 된다.
- 요청 시 매번 세션 저장소를 조회해야 한다.


<br>

---

<br>

## Cookie & Session 비교



|          |                        Cookie                        |     Session      |
| :------: | :--------------------------------------------------: | :--------------: |
| 저장위치 |                        Client                        |      Server      |
| 저장형식 |                         Text                         |      Object      |
| 만료시점 | 쿠키 저장시 설정<br />(설정 없으면 브라우저 종료 시) | 정확한 시점 모름 |
|  리소스  |                 클라이언트의 리소스                  |  서버의 리소스   |
| 용량제한 |           한 도메인 당 20개, 한 쿠키당 4KB           |     제한없음     |



#### 저장 위치

- 쿠키 : 클라이언트의 웹 브라우저가 지정하는 메모리 or 하드디스크
- 세션 : 서버의 메모리에 저장



#### 만료 시점

- 쿠키 : 저장할 때 expires 속성을 정의해 무효화시키면 삭제될 날짜 정할 수 있음
- 세션 : 클라이언트가 로그아웃하거나, 설정 시간동안 반응이 없으면 무효화 되기 때문에 정확한 시점 알 수 없음



#### 리소스

- 쿠키 : 클라이언트에 저장되고 클라이언트의 메모리를 사용하기 때문에 서버 자원 사용하지 않음
- 세션 : 세션은 서버에 저장되고, 서버 메모리로 로딩 되기 때문에 세션이 생길 때마다 리소스를 차지함



#### 용량 제한

- 쿠키 : 클라이언트도 모르게 접속되는 사이트에 의하여 설정될 수 있기 때문에 쿠키로 인해 문제가 발생하는 걸 막고자 한 도메인당 20개, 하나의 쿠키 당 4KB로 제한해 둠
- 세션 : 클라이언트가 접속하면 서버에 의해 생성되므로 개수나 용량 제한 없음

  <br>
  <br>
  <br>
  
참고 https://chrisjune-13837.medium.com/web-%EC%BF%A0%ED%82%A4-%EC%84%B8%EC%85%98%EC%9D%B4%EB%9E%80-aa6bcb327582 / https://github.com/gyoogle/tech-interview-for-developer/blob/master/Web/Cookie%20%26%20Session.md / https://brunch.co.kr/@jinyoungchoi95/1 / https://nesoy.github.io/articles/2017-03/Session-Cookie

